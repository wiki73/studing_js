/**
 * –¢–†–ï–ù–ò–†–û–í–ö–ê: –§–£–ù–ö–¶–ò–ò-–ö–û–ù–°–¢–†–£–ö–¢–û–†–´ (‚Ññ7), IIFE (‚Ññ8), –ö–û–ù–¢–ï–ö–°–¢ this (‚Ññ11)
 */

// ============================
// 1. –§–£–ù–ö–¶–ò–ò-–ö–û–ù–°–¢–†–£–ö–¢–û–†–´
// ============================
// –¢–µ–æ—Ä–∏—è: —Ñ—É–Ω–∫—Ü–∏—è-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–∏—à–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ this –∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ new.
function User(name, age, fLang) {
    this.name = name;
    this.age = age;
    this.favoritLang = fLang;
    this.sayHi = function() {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º this
        console.log(`–ü—Ä–∏–≤–µ—Ç, –º–µ–Ω—è –∑–æ–≤—É—Ç ${this.name} –∏ –º–Ω–µ ${this.age} –ª–µ—Ç!`);
    };
    this.getFavorite = function () {
        console.log(`–õ—é–±–∏–º—ã–π —è–∑—ã–∫ ${this.favoritLang}!`);
    };
}

// –ó–ê–î–ê–ù–ò–ï:
// 1. –°–æ–∑–¥–∞–π –¥–≤—É—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ new User –∏ –≤—ã–∑–æ–≤–∏ –∏—Ö sayHi
// 2. –î–æ–±–∞–≤—å –∫–∞–∂–¥–æ–º—É ¬´–ª—é–±–∏–º—ã–π —è–∑—ã–∫¬ª (lang) –∫–∞–∫ —Å–≤–æ–π—Å—Ç–≤–æ


// –¢–∏–ø–æ–≤–æ–π –ø—Ä–∏–º–µ—Ä:
const user1 = new User('–ö–∞—Ç—è', 24, "–†—É—Å—Å–∫–∏–π");
const user2 = new User('–ï–≥–æ—Ä', 14, "–¢–∞—Ç–∞—Ä—Å–∫–∏–π");
user1.sayHi();
user2.sayHi();
user1.getFavorite();
user2.getFavorite();

// ============================
// 2. IIFE ‚Äî –°–ê–ú–û–í–´–ó–´–í–ê–Æ–©–ò–ï–°–Ø –§–£–ù–ö–¶–ò–ò
// ============================
// –¢–µ–æ—Ä–∏—è: —Å—Ä–∞–∑—É –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏, –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
// –ü—Ä–∏–º–µ—Ä:
(function() {
    console.log('–≠—Ç–æ IIFE ‚Äî –≤—ã–ø–æ–ª–Ω—é—Å—å –æ–¥–∏–Ω —Ä–∞–∑!');
})();

// –ó–ê–î–ê–ù–ò–ï:
// 1. –°–¥–µ–ª–∞–π IIFE, –≤ –∫–æ—Ç–æ—Ä–æ–π —Å—á–∏—Ç–∞–µ—Ç—Å—è —Å—É–º–º–∞ –¥–≤—É—Ö —á–∏—Å–µ–ª
// 2. –°–¥–µ–ª–∞–π IIFE, –≤–Ω—É—Ç—Ä—å –∫–æ—Ç–æ—Ä–æ–π –ø–æ–ø–∞–¥—ë—Ç –º–∞—Å—Å–∏–≤, –∞ –Ω–∞—Ä—É–∂—É ‚Äî —Ç–æ–ª—å–∫–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
(function() {
    const sum = 1 + 2;
    console.log(sum);
})();
arr = [1, 2, 3, 4, 5];
(function(arr) {
    const max = Math.max(...arr);
    console.log(max);
})(arr);
// ============================
// 3. –ö–û–ù–¢–ï–ö–°–¢ this
// ============================
// –¢–µ–æ—Ä–∏—è: –∑–Ω–∞—á–µ–Ω–∏–µ this –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–ø–æ—Å–æ–±–∞ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏. –í –º–µ—Ç–æ–¥–∞—Ö –æ–±—ä–µ–∫—Ç–æ–≤ ‚Äî —ç—Ç–æ —Å–∞–º –æ–±—ä–µ–∫—Ç.

const obj = {
    value: 42,
    show: function() {
        console.log(this.value); // this ‚Äî —Ç–æ—Ç –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–æ–∏—Ç ¬´—Å–ª–µ–≤–∞ –æ—Ç —Ç–æ—á–∫–∏¬ª
    }
};

// –ó–ê–î–ê–ù–ò–ï:
// 1. –ü–æ–∫–∞–∂–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –æ–±—ã—á–Ω–æ–π –∏ —Å—Ç—Ä–µ–ª–æ—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –∫–∞–∫ –º–µ—Ç–æ–¥–æ–º –æ–±—ä–µ–∫—Ç–∞
// 2. –ò—Å–ø–æ–ª—å–∑—É–π call/apply/bind, —á—Ç–æ–±—ã –ø–æ–¥–º–µ–Ω–∏—Ç—å this –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ show

// –ü–∏—à–∏ —Å–≤–æ–∏ —Ä–µ—à–µ–Ω–∏—è –Ω–∏–∂–µ üëá

// 1. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –æ–±—ã—á–Ω–æ–π –∏ —Å—Ç—Ä–µ–ª–æ—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –∫–∞–∫ –º–µ—Ç–æ–¥–æ–º –æ–±—ä–µ–∫—Ç–∞
const testObj = {
    value: 100,
    // –û–±—ã—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - this –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –æ–±—ä–µ–∫—Ç—É
    normalMethod: function() {
        console.log('–û–±—ã—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, this.value =', this.value);
    },
    // –°—Ç—Ä–µ–ª–æ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è - this –±–µ—Ä—ë—Ç—Å—è –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –æ–±—ä–µ–∫—Ç—É)
    arrowMethod: () => {
        console.log('–°—Ç—Ä–µ–ª–æ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, this.value =', this.value); // undefined
    }
};

console.log('--- –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –æ–±—ã—á–Ω–æ–π –∏ —Å—Ç—Ä–µ–ª–æ—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π ---');
testObj.normalMethod(); // this = testObj, –≤—ã–≤–µ–¥–µ—Ç 100
testObj.arrowMethod(); // this = –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç (–∏–ª–∏ undefined –≤ —Å—Ç—Ä–æ–≥–æ–º —Ä–µ–∂–∏–º–µ)

// –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –º–µ—Ç–æ–¥
const normalFn = testObj.normalMethod;
const arrowFn = testObj.arrowMethod;
console.log('--- –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ---');
normalFn(); // this = undefined (–ø–æ—Ç–µ—Ä—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞!)
arrowFn(); // this –≤—Å—ë —Ä–∞–≤–Ω–æ –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

// 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ call/apply/bind –¥–ª—è –ø–æ–¥–º–µ–Ω—ã this
console.log('\n--- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ call/apply/bind ---');

const obj1 = { value: 10 };
const obj2 = { value: 20 };
const obj3 = { value: 30 };

// call - –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º this –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
obj.show.call(obj1); // this = obj1, –≤—ã–≤–µ–¥–µ—Ç 10

// apply - –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º this –∏ –º–∞—Å—Å–∏–≤–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
obj.show.apply(obj2); // this = obj2, –≤—ã–≤–µ–¥–µ—Ç 20

// bind - —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é —Å –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º this (–Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Å—Ä–∞–∑—É)
const boundShow = obj.show.bind(obj3);
boundShow(); // this = obj3, –≤—ã–≤–µ–¥–µ—Ç 30

// –ü—Ä–∏–º–µ—Ä —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è call –∏ apply
function greet(greeting, punctuation) {
    console.log(`${greeting}, value = ${this.value}${punctuation}`);
}

greet.call(obj1, '–ü—Ä–∏–≤–µ—Ç', '!'); // –ü—Ä–∏–≤–µ—Ç, value = 10!
greet.apply(obj2, ['–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π', '.']); // –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π, value = 20.
